-- 1. Criação da tabela de vendas
DROP TABLE VENDAS PURGE;

CREATE TABLE VENDAS (
    id            NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    produto       VARCHAR2(100) NOT NULL,
    categoria     VARCHAR2(50)  NOT NULL,
    valor         NUMBER(10,2)  NOT NULL CHECK (valor > 0),
    data_venda    DATE          DEFAULT SYSDATE,
    vendedor      VARCHAR2(100) NOT NULL
);

INSERT INTO VENDAS (produto, categoria, valor, data_venda, vendedor) 
VALUES 
    ('Notebook Dell', 'Eletrônicos', 4500.00, DATE '2025-04-01', 'Carlos'),
    ('Mouse Gamer', 'Acessórios', 150.00, DATE '2025-04-01', 'Ana'),
    ('Teclado Mecânico', 'Acessórios', 300.00, DATE '2025-04-02', 'Carlos'),
    ('Monitor 24"', 'Eletrônicos', 1200.00, DATE '2025-04-02', 'Bruna'),
    ('Fone Bluetooth', 'Acessórios', 200.00, DATE '2025-04-03', 'Ana'),
    ('Notebook HP', 'Eletrônicos', 4000.00, DATE '2025-04-03', 'Carlos'),
    ('Webcam HD', 'Acessórios', 180.00, DATE '2025-04-04', 'Bruna'),
    ('Carregador Portátil', 'Acessórios', 120.00, DATE '2025-04-04', 'Ana'),
    ('SSD 1TB', 'Componentes', 500.00, DATE '2025-04-05', 'Carlos'),
    ('Cabo HDMI', 'Acessórios', 50.00, DATE '2025-04-05', 'Bruna');

-- Relatório 1: Todas as vendas registradas
SELECT * FROM VENDAS;

-- Relatório 2: Apenas produto, valor e vendedor
SELECT produto, valor, vendedor
FROM VENDAS;

-- Relatório 3: Apenas vendas da categoria "Acessórios"
SELECT produto, valor, vendedor, data_venda
FROM VENDAS
WHERE categoria = 'Acessórios';

-- Relatório 4: Produtos com valor maior que R$1000
SELECT produto, categoria, valor
FROM VENDAS
WHERE valor > 1000;

-- Relatório 5: Vendas realizadas em 03/04/2025
SELECT produto, valor, vendedor
FROM VENDAS
WHERE data_venda = DATE '2025-04-03';

-- Relatório 6: Vendas ordenadas do mais caro para o mais barato
SELECT produto, valor, categoria
FROM VENDAS
ORDER BY valor DESC;

SELECT produto, valor, data_venda
FROM VENDAS
WHERE vendedor = 'Carlos'
ORDER BY data_venda;

-- Relatório 8: Produtos que contêm a palavra "Notebook"
SELECT produto, valor, categoria
FROM VENDAS
WHERE produto LIKE '%Notebook%';

-- Relatório 9: Valor total de todas as vendas
SELECT SUM(valor) AS total_geral
FROM VENDAS;

-- Relatório 10: Estatísticas de preços
SELECT
    AVG(valor) AS media_preco,
    MIN(valor) AS menor_preco,
    MAX(valor) AS maior_preco,
    COUNT(*)   AS total_vendas
FROM VENDAS;

-- Relatório 11: Total de vendas e receita por categoria
SELECT
    categoria,
    COUNT(*) AS qtd_vendas,
    SUM(valor) AS receita_total
FROM VENDAS
GROUP BY categoria
ORDER BY receita_total DESC;

-- Relatório 12: Listar categorias distintas
SELECT DISTINCT categoria
FROM VENDAS;


-- ATIVIDADES 

-- EXERCÍCIO A
SELECT produto, valor, data_venda
FROM VENDAS
WHERE vendedor = 'Ana'
ORDER BY data_venda;

-- EXERCÍCIO B
SELECT SUM(valor) AS total_eletronicos
FROM VENDAS
WHERE categoria = 'Eletrônicos';

-- EXERCÍCIO C
SELECT produto, valor
FROM VENDAS
WHERE valor BETWEEN 200 AND 1000;

-- EXERCÍCIO D
SELECT
    vendedor,
    COUNT(*) AS qtd_vendas,
    SUM(valor) AS total_vendido
FROM VENDAS
GROUP BY vendedor
ORDER BY total_vendido DESC;